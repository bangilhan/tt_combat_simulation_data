# CS:GO Combat Simulation Platform

CS:GO 데모 리플레이 데이터를 3D로 시뮬레이션하고 분석하는 종합 웹 플랫폼입니다. Getgud.io 스타일의 인터페이스로 전투 상황을 시각화하고, 플레이어 행동 패턴을 분석합니다.

## 📋 목차

1. [시뮬레이션 플랫폼 구성](#시뮬레이션-플랫폼-구성)
2. [입력 데이터 구조](#입력-데이터-구조)
3. [주요 기능](#주요-기능)
4. [목적 및 가치](#목적-및-가치)
5. [사용 방법](#사용-방법)
6. [팀원들과 공유하기](#팀원들과-공유하기)

---

## 🏗️ 시뮬레이션 플랫폼 구성

### 아키텍처
- **프론트엔드**: 순수 HTML/CSS/JavaScript (Three.js 기반)
- **백엔드**: 없음 (브라우저에서 직접 CSV 파일 처리)
- **3D 엔진**: Three.js r128
- **데이터 처리**: PapaParse (CSV 파싱)

### UI 레이아웃

```
┌─────────────────────────────────────────────────────────┐
│  Top Navigation (Dashboard, Manage, Investigate)       │
├──────────┬──────────────────────────────────────────────┤
│          │                                              │
│ Sidebar  │         3D Simulation Canvas                │
│          │      (Three.js 렌더링 영역)                  │
│ - File   │                                              │
│ - Stats  │                                              │
│ - Players│                                              │
│          │                                              │
├──────────┴──────────────────────────────────────────────┤
│  Bottom Panel (드래그로 크기 조절 가능)                  │
│  ├─ Controls (재생, 타임라인, 속도)                      │
│  ├─ Tabs (Action Stream / Match Chat / Aim Trace)       │
│  └─ Event Log / Aim Trace Visualization                 │
└─────────────────────────────────────────────────────────┘
```

---

## 📊 입력 데이터 구조

### 필수 CSV 컬럼

#### 기본 정보
- `tick`: 게임 틱 번호 (정수)
- `game_time`: 게임 시간 (초, 실수)
- `round`: 라운드 번호 (정수)
- `team_name`: 팀명 (`CT` 또는 `TERRORIST`)
- `name`: 플레이어 이름 (문자열)

#### 플레이어 위치 (모든 틱에 존재)
- `X`, `Y`, `Z`: 플레이어 3D 좌표 (실수)
- `health`: 플레이어 체력 (0-100, 실수)

#### 킬 이벤트 데이터 (킬 발생 시점에만 존재)
- `event`: 이벤트 타입 (예: "kill", "died")
- `attacker_name`: 공격자 이름
- `attacker_team_name`: 공격자 팀
- `attacker_X`, `attacker_Y`, `attacker_Z`: 공격자 위치
- `attacker_yaw`, `attacker_pitch`: 공격자 마우스 조준 각도
- `attacker_health`: 공격자 체력
- `victim_name`: 피해자 이름
- `victim_team_name`: 피해자 팀
- `victim_X`, `victim_Y`, `victim_Z`: 피해자 위치
- `victim_health`: 피해자 체력
- `weapon`: 사용 무기
- `headshot`: 헤드샷 여부 (boolean)

### 데이터 특성

- **시간 기반 시퀀스 데이터**: 각 행은 특정 틱의 스냅샷
- **스파스 이벤트**: 킬 이벤트는 해당 틱에만 존재 (나머지 필드는 null)
- **플레이어 추적**: 모든 틱에서 플레이어 위치 정보 제공
- **좌표계**: Source 엔진 좌표계 (X: 좌우, Y: 전후, Z: 높이)

---

## 🎯 주요 기능

### 1. 3D 시뮬레이션 시각화

#### 플레이어 표현
- **CT 팀**: 파란색 구형 마커
- **T 팀**: 빨간색 삼각형 원뿔 마커
- **플레이어 이름 라벨**: 큰 폰트(36px) + 팀 색상 테두리
- **이동 경로 트레일**: 최근 100틱의 이동 경로 표시

#### 맵 경계 및 구역
- **자동 경계 계산**: 모든 플레이어 위치 기반으로 맵 경계 자동 산정
- **구역 표시**: 10x10 그리드로 맵 구역 구분 (A1~C3 라벨)
- **좌표축**: 중심점 기준 X, Y, Z 축 표시

#### 킬 이벤트 시각화
- **공격자 마커**: 빨간색 원뿔 (공격 위치)
- **공격-피해 연결선**: 공격자에서 피해자로 빨간색 선
- **피해자 라벨**: "KILLED" + "HEADSHOT" (헤드샷인 경우)
- **페이드아웃**: 킬 발생 후 2-3초 동안 점진적으로 사라짐

### 2. 인터랙티브 컨트롤

#### 카메라 제어
- **마우스 드래그**: 카메라 회전 (궤도 컨트롤)
- **마우스 휠**: 줌 인/아웃 (맵 크기 기반 최소/최대 거리)
- **Reset View**: 맵 중심으로 카메라 복귀

#### 재생 컨트롤
- **재생/일시정지**: ▶/⏸ 버튼
- **타임라인**: 클릭으로 특정 시점 이동
- **재생 속도**: 0.5x, 1x, 2x, 3x
- **시간 표시**: 현재 시간 / 총 시간 (mm:ss.mmm 형식)

### 3. 킬 이벤트 필터링 및 포커스

#### Kill Event Picker (좌측 상단)
- 드롭다운에서 킬 이벤트 선택
- "Go" 버튼으로 해당 시점으로 즉시 이동
- **포커스 모드**: 선택한 킬 이벤트 기준 ±30틱 범위 자동 설정
  - 재생 범위가 해당 구간으로 제한
  - 이벤트 로그도 해당 구간만 표시
  - Aim Trace도 동일 구간으로 동기화

#### Action Stream (하단)
- 실시간 이벤트 로그
- **색상 구분**:
  - 시간: 파란색 (#6b9bd5)
  - 공격자: 파란색 (#4a90e2)
  - 동사: 회색 (#8a8fa5)
  - 피해자: 빨간색 (#ff6b6b)
  - 무기: 주황색 (#ffa500)
- 이벤트 클릭 시 포커스 모드 활성화

### 4. 플레이어 추적 시스템

#### 플레이어 선택 (좌측 상단)
- 드롭다운에서 플레이어 선택
- **Prev/Next 버튼**: 선택한 플레이어의 이전/다음 시점으로 점프
- **Follow 버튼**: 카메라가 선택한 플레이어를 따라가며 중앙에 배치
  - 재생 중에도 플레이어 위치를 중심으로 카메라 자동 이동

#### 플레이어 정보 (좌측 사이드바)
- **K/D Ratio**: Kills / Deaths 표시
- **플레이어 클릭**: 해당 플레이어가 참여한 첫 번째 킬 이벤트로 이동

### 5. Aim Trace 분석

#### 2D 조준 궤적 시각화
- **좌표계**: 
  - X축: Yaw (-180° ~ 180°)
  - Y축: Pitch (-90° ~ 90°)
- **포인트 색상**:
  - 파란색: 현재 마우스 위치 (일반 이동)
  - 노란색: 공격 시점 마우스 위치
  - 빨간색: Hit 시점 마우스 위치
  - 진빨강: Kill 시점 마우스 위치 (큰 원 + 테두리)
- **현재 틱 하이라이트**: 재생 중인 틱의 마우스 위치를 큰 파란 점으로 표시

#### 실시간 동기화
- 재생 중 Aim Trace도 함께 업데이트
- 포커스 모드 시 해당 구간(±30틱)만 표시
- 킬 이벤트 선택 시 공격자의 Aim Trace 자동 표시

#### 에임봇 탐지 지표
- **Straightness Score**: 직선성 지표
  - 계산식: 직선 거리 / 경로 길이
  - 1에 가까울수록 직선 이동 (에임봇 의심)
  - 제목에 실시간 표시

### 6. 통계 정보 (좌측 사이드바)

#### Match Info
- **Title**: 게임 이름 (CS2)
- **Game**: 서버, 모드, 시작 시간, 길이, 플레이어 수
- **Match**: 매치 시작 시간, 길이, 모드, 맵 이름, 총 이벤트 수
- **Map Bounds**: 맵 경계 좌표 및 크기
- **Players**: 플레이어 목록 및 K/D Ratio

### 7. UI 커스터마이징

#### 하단 패널 크기 조절
- 상단 가장자리를 드래그하여 높이 조절
- 최소 160px, 최대 화면 높이의 80%
- 설정은 localStorage에 저장되어 재방문 시 유지

#### 탭 전환
- **Action Stream**: 실시간 이벤트 로그
- **Match Chat**: 채팅 로그 (향후 확장)
- **Aim Trace**: 조준 궤적 분석

---

## 💡 목적 및 가치

### 1. 전투 분석
- **전술 분석**: 플레이어 위치, 이동 패턴, 전투 상황 파악
- **킬 이벤트 상세 분석**: 공격자-피해자 관계, 무기 사용, 헤드샷 비율
- **시간 기반 분석**: 특정 시점 전후 상황 추적

### 2. 치팅 탐지
- **에임봇 탐지**: Aim Trace의 직선성 분석으로 비정상적인 마우스 이동 패턴 식별
- **행동 패턴 분석**: 플레이어별 이동 및 조준 패턴 비교
- **의심도 지표**: Straightness Score로 객관적 평가

### 3. 교육 및 학습
- **전투 시뮬레이션**: 실제 경기 상황을 3D로 재현하여 학습
- **플레이어 추적**: 개별 플레이어의 움직임과 전술 분석
- **실시간 재생**: 다양한 속도로 상황 재현

### 4. 데이터 시각화
- **대규모 데이터 처리**: 수만 줄의 CSV 데이터를 실시간으로 처리
- **인터랙티브 탐색**: 클릭, 드래그, 필터링으로 원하는 정보 즉시 접근
- **맵 기반 시각화**: 3D 공간에서 플레이어 위치와 이벤트를 직관적으로 표시

---

## 🚀 사용 방법

### 1. 파일 준비
- CSV 파일 준비: `sample_dataset_kill_tick_info.csv` 형식 준수

### 2. 브라우저에서 실행
```bash
# 파일 탐색기에서 index.html 더블클릭
# 또는
explorer index.html
```

### 3. 데이터 로드
1. 좌측 사이드바 "File Load" 섹션에서 CSV 파일 선택
2. 처리 완료까지 대기 (진행 상황 콘솔에 표시)

### 4. 시뮬레이션 탐색
- **3D 시각화**: 캔버스에서 마우스로 카메라 조작
- **킬 이벤트 선택**: 좌측 상단 Kill Event Picker에서 선택
- **플레이어 추적**: Players 드롭다운에서 플레이어 선택 후 Follow 활성화
- **Aim Trace 분석**: 하단 Aim Trace 탭에서 조준 궤적 확인

### 5. 포커스 모드 활용
1. 킬 이벤트 선택 (Event Picker 또는 Action Stream)
2. 자동으로 ±30틱 범위 설정
3. 재생 버튼으로 해당 구간 반복 재생
4. Aim Trace에서 공격자의 마우스 이동 패턴 확인

---

## 🌐 팀원들과 공유하기

GitHub에 소스 코드가 올라가 있는 상황에서, CSV 파일과 함께 팀원들과 공유하는 방법입니다.

### 방법 1: GitHub Pages (추천) ⭐

**장점**: 무료, 간단한 설정, CSV 파일도 함께 호스팅 가능

#### 설정 방법:

1. **CSV 파일을 GitHub에 포함**
   ```bash
   # CSV 파일이 이미 저장소에 있는지 확인
   git add sample_dataset_kill_tick_info.csv
   git commit -m "Add sample CSV dataset"
   git push
   ```

2. **GitHub Pages 활성화**
   - GitHub 저장소 페이지로 이동
   - `Settings` → `Pages` 메뉴 클릭
   - `Source`에서 `Deploy from a branch` 선택
   - `Branch`를 `main` (또는 `master`) 선택
   - `Folder`를 `/ (root)` 선택
   - `Save` 클릭

3. **배포 확인**
   - 몇 분 후 `https://[사용자명].github.io/[저장소명]/` 주소로 접속 가능
   - 예: `https://username.github.io/combat_simulation/`

4. **팀원들에게 공유**
   - 배포된 URL을 팀원들에게 공유
   - 팀원들은 웹 브라우저에서 바로 접속하여 사용 가능
   - CSV 파일은 웹에서 직접 다운로드하거나, GitHub에서 다운로드 가능

#### 주의사항:
- CSV 파일이 100MB 이상이면 GitHub에 올리기 어려울 수 있습니다
- 이 경우 방법 2 (Vercel) 또는 방법 3 (로컬 실행)을 사용하세요

---

### 방법 2: Vercel 배포

**장점**: 이미 설정 파일(`vercel.json`)이 있음, 빠른 배포, 큰 파일 지원

#### 설정 방법:

1. **Vercel 계정 생성 및 연결**
   - [vercel.com](https://vercel.com) 접속
   - GitHub 계정으로 로그인
   - `New Project` 클릭
   - GitHub 저장소 선택

2. **배포 설정**
   - `Framework Preset`: Other 선택
   - `Root Directory`: `.` (현재 디렉토리)
   - `Build Command`: 비워두기 (빌드 불필요)
   - `Output Directory`: `.` 선택
   - `Deploy` 클릭

3. **배포 완료**
   - 자동으로 배포 URL 생성 (예: `https://combat-simulation.vercel.app`)
   - 이후 코드 푸시 시 자동 재배포

4. **팀원들에게 공유**
   - Vercel 배포 URL 공유
   - CSV 파일은 GitHub에서 다운로드하거나, Vercel 배포본에서 직접 접근 가능

---

### 방법 3: 로컬 실행 (각자 다운로드)

**장점**: 인터넷 연결 불필요, 완전한 오프라인 사용 가능

#### 설정 방법:

1. **GitHub에서 클론**
   ```bash
   git clone https://github.com/[사용자명]/[저장소명].git
   cd [저장소명]
   ```

2. **CSV 파일 확인**
   - `sample_dataset_kill_tick_info.csv` 파일이 포함되어 있는지 확인
   - 없다면 GitHub에서 직접 다운로드

3. **브라우저에서 실행**
   - `index.html` 파일을 더블클릭하여 브라우저에서 열기
   - 또는 로컬 서버 실행:
     ```bash
     # Python 3
     python -m http.server 8000
     
     # Node.js (http-server 설치 필요)
     npx http-server -p 8000
     ```
   - 브라우저에서 `http://localhost:8000` 접속

4. **CSV 파일 로드**
   - 좌측 사이드바에서 CSV 파일 선택하여 로드

---

### 방법 비교

| 방법 | 장점 | 단점 | 추천 대상 |
|------|------|------|----------|
| **GitHub Pages** | 무료, 간단, CSV 포함 | 파일 크기 제한 (100MB) | 소규모 CSV 파일 |
| **Vercel** | 빠른 배포, 큰 파일 지원 | 계정 필요 | 프로덕션 배포 |
| **로컬 실행** | 오프라인 가능, 완전한 제어 | 각자 설정 필요 | 개발/테스트 환경 |

---

### CSV 파일이 큰 경우 (100MB 이상)

1. **GitHub Releases 사용**
   - GitHub 저장소 → `Releases` → `Create a new release`
   - CSV 파일을 첨부 파일로 업로드
   - 팀원들은 Releases 페이지에서 다운로드

2. **외부 스토리지 사용**
   - Google Drive, Dropbox 등에 CSV 파일 업로드
   - 공유 링크를 README에 추가
   - 팀원들은 링크에서 다운로드 후 로컬에서 사용

3. **Git LFS 사용** (고급)
   ```bash
   git lfs install
   git lfs track "*.csv"
   git add .gitattributes
   git add sample_dataset_kill_tick_info.csv
   git commit -m "Add CSV with Git LFS"
   git push
   ```

---

## 📁 파일 구조

```
combat_simulation/
├── simulation_enhanced.html    # 메인 시뮬레이션 파일 (독립 실행)
├── sample_dataset_kill_tick_info.csv  # 입력 데이터
├── README.md                  # 이 문서
├── data_processor.py          # (선택) 데이터 전처리 스크립트
├── app.py                     # (선택) Flask 서버 (사용 안 함)
└── requirements.txt           # (선택) Python 패키지 목록
```

---

## 🎮 컨트롤 요약

| 입력 | 동작 |
|------|------|
| 마우스 드래그 | 카메라 회전 |
| 마우스 휠 | 줌 인/아웃 |
| 재생 버튼 | 시뮬레이션 시작/일시정지 |
| 타임라인 클릭 | 특정 시점으로 이동 |
| 속도 버튼 | 재생 속도 조절 (0.5x ~ 3x) |
| 하단 패널 상단 가장자리 드래그 | 패널 높이 조절 |
| ESC 키 | 포커스 모드 종료 |

---

## 🔧 기술 스택

- **Three.js r128**: 3D 렌더링
- **PapaParse**: CSV 파싱
- **Canvas API**: 2D 그래프 및 라벨 렌더링
- **LocalStorage**: UI 설정 저장
- **순수 JavaScript**: 외부 프레임워크 없이 구현

---

## 📝 향후 개선 가능 사항

- [ ] 실제 CS:GO 맵 텍스처 및 지형 로드
- [ ] 다중 플레이어 동시 추적
- [ ] 히트맵 시각화
- [ ] 통계 대시보드 확장
- [ ] 에임봇 탐지 알고리즘 고도화
- [ ] 데이터 내보내기 기능

---

## 📄 라이선스

이 프로젝트는 교육 및 연구 목적으로 제작되었습니다.
# fps_combat_simulation
